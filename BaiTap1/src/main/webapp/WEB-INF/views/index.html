<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="/webjars/bootstrap/5.1.3/css/bootstrap.min.css"/>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>
    let currentPage = 0;
    let currentKeyword = "";

    function loadPosts(reset = false) {
      $.ajax({
        url: '/api/posts',
        method: 'GET',
        data: {
          keyword: currentKeyword,
          page: currentPage
        },
        success: function (posts) {
          if (reset) $('#post-list').html('');
          if (posts.length === 0 && currentPage === 0) {
            $('#post-list').html('<p>Không tìm thấy bài viết nào.</p>');
            $('#load-more').hide();
            return;
          }

          posts.forEach(function (post) {
            $('#post-list').append(`
            <div class="card mb-2">
              <div class="card-body">
                <h5>${post.title}</h5>
                <p>${post.content}</p>
              </div>
            </div>
          `);
          });

          if (posts.length < 2) {
            $('#load-more').hide();
          } else {
            $('#load-more').show();
          }

          currentPage++;
        }
      });
    }

    $(document).ready(function () {
      // Load lần đầu
      loadPosts();

      // Tìm kiếm
      $('#search-form').submit(function (e) {
        e.preventDefault();
        currentKeyword = $('#search-keyword').val().trim();
        currentPage = 0;
        loadPosts(true);
      });

      // Tải thêm
      $('#load-more').click(function () {
        loadPosts();
      });
    });
  </script>
</head>
<body>
<div class="container mt-3">
  <form id="search-form">
    <input type="text" id="search-keyword" class="form-control" placeholder="Tìm kiếm bài viết...">
    <button class="btn btn-primary mt-2">Tìm kiếm</button>
  </form>

  <div id="post-list" class="mt-4"></div>

  <button id="load-more" class="btn btn-secondary mt-3">Tải thêm</button>
</div>
</body>
</html>